(()=>{var ae=Object.create,B=Object.defineProperty,ce=Object.getPrototypeOf,de=Object.prototype.hasOwnProperty,ue=Object.getOwnPropertyNames,le=Object.getOwnPropertyDescriptor;var ge=r=>B(r,"__esModule",{value:!0});var _=(r,e)=>()=>(e||(e={exports:{}},r(e.exports,e)),e.exports),S=(r,e)=>{for(var t in e)B(r,t,{get:e[t],enumerable:!0})},fe=(r,e,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of ue(e))!de.call(r,s)&&s!=="default"&&B(r,s,{get:()=>e[s],enumerable:!(t=le(e,s))||t.enumerable});return r},h=r=>fe(ge(B(r!=null?ae(ce(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);var E=_(g=>{"use strict";var v=g&&g.__awaiter||function(r,e,t,s){function i(n){return n instanceof t?n:new t(function(a){a(n)})}return new(t||(t=Promise))(function(n,a){function d(l){try{c(s.next(l))}catch(m){a(m)}}function f(l){try{c(s.throw(l))}catch(m){a(m)}}function c(l){l.done?n(l.value):i(l.value).then(d,f)}c((s=s.apply(r,e||[])).next())})},T=g&&g.__generator||function(r,e){var t={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},s,i,n,a;return a={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function d(c){return function(l){return f([c,l])}}function f(c){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,i&&(n=c[0]&2?i.return:c[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,c[1])).done)return n;switch(i=0,n&&(c=[c[0]&2,n.value]),c[0]){case 0:case 1:n=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(n=t.trys,!(n=n.length>0&&n[n.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!n||c[1]>n[0]&&c[1]<n[3])){t.label=c[1];break}if(c[0]===6&&t.label<n[1]){t.label=n[1],n=c;break}if(n&&t.label<n[2]){t.label=n[2],t.ops.push(c);break}n[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(l){c=[6,l],i=0}finally{s=n=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}};Object.defineProperty(g,"__esModule",{value:!0});g.throwIfVersionIsNotSupported=g.IsVersonSupportedByHost=g.isPIEHostPresent=g.HostBridge=g.NoopPostProcessingFactory=g.Uint8ArrayPostProcessingFactory=g.PointerPostProcessingFactory=g.DatePostProcessingFactory=void 0;var pe=1,Ie=2,H=2,M;function ye(){return M||(M={convert:function(r){return new Date(r)}}),M}g.DatePostProcessingFactory=ye;var k;function me(){return k||(k={convert:function(r){return new Uint32Array([r[0],r[1]])}}),k}g.PointerPostProcessingFactory=me;var A;function he(){return A||(A={convert:function(r){return new Uint8Array(r)}}),A}g.Uint8ArrayPostProcessingFactory=he;var O;function Pe(){return O||(O={}),O}g.NoopPostProcessingFactory=Pe;function ve(r){throw new Error("Resolve must not be called")}function Te(r){throw new Error("Reject must not be called")}var b=function(){function r(){this.nextHandlerId=1,this.registeredHandlers=new Map}return r.prototype.registerHandler=function(e){var t=this,s=this.nextHandlerId;return this.nextHandlerId=this.nextHandlerId+1,this.registeredHandlers.set(s,e),function(){t.unregisterHandler(s)}},r.prototype.RaiseEvent=function(e){this.registeredHandlers.forEach(function(t){t(e)})},r.prototype.HasHandlers=function(){return this.registeredHandlers.size!==0},r.prototype.unregisterHandler=function(e){this.registeredHandlers.has(e)&&this.registeredHandlers.delete(e)},r}(),U;(function(r){r[r.Callback=0]="Callback",r[r.Forwarder=1]="Forwarder"})(U||(U={}));var J=function(){function r(){this.nextMessageId=1,this.pendingMessages=new Map,this.eventHandlers=new Map,this.invokeHandlers=new Map,this.eventForwarders=new b,this.abandonedCallHandlers=new b,this.namespaceVersionChangeHandlers=new b,this.hostNotificationHandlers=new b,this.firstSyncIdCall=!0,this.timedoutCallsHandlers=new b,this.nextSyncId=1,this.maxMessageId=1073741823}return r.prototype.resetSyncIdsForUnitTests=function(){this.firstSyncIdCall=!0,this.nextSyncId=1},r.prototype.isNamespaceVersionChange=function(e){return e.isIdRequest&&e.messageName==="version-change"&&e.messageId===-3},r.prototype.sendMessageToHost=function(e,t,s){this.raiseMessageInfoIfNeeded(t,!0,!0,s),e.sendMessageToHost(t)},r.prototype.sendMessageToHostSync=function(e,t,s){this.raiseMessageInfoIfNeeded(t,!0,!1,s),e.sendMessageToHostSync(t)},r.prototype.handleInvokableCall=function(e,t){return v(this,void 0,void 0,function(){var s,i,n,a,d,f,c;return T(this,function(l){switch(l.label){case 0:if(s=function(m){var w={wasSuccessful:!0,result:m??{}},N={contentType:"app/pie",messageName:e.messageName,messageId:e.messageId,isInvokable:!0,message:w};this.sendMessageToHost(t,N)}.bind(this),i=function(m){var w={wasSuccessful:!1,errorMessage:m.message},N={contentType:"app/pie",messageName:e.messageName,messageId:e.messageId,isInvokable:!0,message:w};this.sendMessageToHost(t,N)}.bind(this),n=this.invokeHandlers.get(e.messageName),!n)return[3,7];if(n.type!==U.Callback)return[3,5];a=n.handler,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,a(e.message)];case 2:return d=l.sent(),s(d),[3,4];case 3:return f=l.sent(),i(f),[3,4];case 4:return[3,6];case 5:c=n.handler,c(e),l.label=6;case 6:return[3,8];case 7:i(new Error("No invoke handler registered")),l.label=8;case 8:return[2]}})})},r.prototype.onMessageFromHost=function(e,t){var s,i;if((e==null?void 0:e.contentType)==="app/pie")if(this.raiseMessageInfoIfNeeded(e,!1,(e==null?void 0:e.syncId)===void 0),e.isEvent){var n=e.messageName;this.eventHandlers.has(n)&&this.eventHandlers.get(n).RaiseEvent(e.args),this.eventForwarders.RaiseEvent(e)}else if(e.isInvokable)this.handleInvokableCall(e,t);else{var a=e.messageId;if(this.pendingMessages.has(a)){var d=this.pendingMessages.get(a);this.pendingMessages.delete(a),d.proxyHandler?d.proxyHandler(e):e.abandoned?this.abandonedCallHandlers.RaiseEvent(e.messageName):e.wasSuccessful?(((s=d.postProcessing)===null||s===void 0?void 0:s.process)&&d.postProcessing.process(e.message),d.resolve(((i=d.postProcessing)===null||i===void 0?void 0:i.convert)?d.postProcessing.convert(e.message):e.message)):d.reject(new Error(e.messageName+":"+e.errorMessage))}else this.isNamespaceVersionChange(e)&&this.namespaceVersionChangeHandlers.RaiseEvent(e.message)}},r.prototype.addMessageToPendingMessages=function(e,t,s,i){var n=this.nextMessageId;this.nextMessageId=this.nextMessageId===this.maxMessageId?1:this.nextMessageId+1;var a={resolve:e,reject:t,postProcessing:s,proxyHandler:i};return this.pendingMessages.set(n,a),n},r.prototype.invokeIdRequest=function(e,t,s,i,n){var a=this.addMessageToPendingMessages(i,n),d={contentType:"app/pie",messageName:t,isIdRequest:!0,messageId:a,message:s};this.sendMessageToHost(e,d)},r.makePieSyncNotSupportedError=function(){return new Error("Synchronous bridge not supported")},r.prototype.getNextSyncId=function(e){this.firstSyncIdCall&&(this.nextSyncId=e.getStartingSyncId(),this.firstSyncIdCall=!1);var t=this.nextSyncId;return this.nextSyncId=this.nextSyncId===Number.MAX_SAFE_INTEGER?1:this.nextSyncId+1,t},r.prototype.invokeOnHostSync=function(e,t,s,i,n,a){if(e.sendMessageToHostSync){var d=this.addMessageToPendingMessages(i,n,a),f=this.getNextSyncId(e),c={contentType:"app/pie",messageName:t,syncId:f,messageId:d,message:s};this.sendMessageToHostSync(e,c)}else throw r.makePieSyncNotSupportedError()},r.prototype.invokeOnHost=function(e,t,s,i,n,a){var d=this.addMessageToPendingMessages(i,n,a),f={contentType:"app/pie",messageName:t,messageId:d,message:s};this.sendMessageToHost(e,f)},r.prototype.forwardProxyMessage=function(e,t,s){if((t==null?void 0:t.contentType)!=="app/pie"){s(null);return}if(t.isInvokable){this.sendMessageToHost(e,t),s(null);return}var i=t.messageId,n=function(d){d.messageId=i,s(d)},a=this.addMessageToPendingMessages(ve,Te,void 0,n);t.messageId=a,this.sendMessageToHost(e,t,!0)},r.prototype.registerForEvent=function(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new b),this.eventHandlers.get(e).registerHandler(t)},r.prototype.registerForInvokable=function(e,t){var s=this;if(this.invokeHandlers.has(e))throw new Error("A handler for invokable "+e+" is already registerd");return this.invokeHandlers.set(e,t),function(){s.invokeHandlers.delete(e)}},r.prototype.registerEventForwarder=function(e){return this.eventForwarders.registerHandler(e)},r.prototype.registerForAbandonedCalls=function(e){return this.abandonedCallHandlers.registerHandler(e)},r.prototype.registerForNamespaceVersionChange=function(e){return this.namespaceVersionChangeHandlers.registerHandler(e)},r.prototype.registerForHostMessageNotification=function(e){return this.hostNotificationHandlers.registerHandler(e)},r.prototype.invokeHostEvent=function(e,t,s){var i={contentType:"app/pie",messageName:t,isEvent:!0,message:s};this.sendMessageToHost(e,i)},r.prototype.timeoutCall=function(e,t,s){if(this.pendingMessages.has(t)){var i=e+":"+s,n=this.pendingMessages.get(t);if(this.pendingMessages.delete(t),n.proxyHandler){var a={contentType:"app/pie",messageName:e,messageId:t,wasSuccessful:!1,errorMessage:i};n.proxyHandler(a)}else n.reject(new Error(i)),this.timedoutCallsHandlers.RaiseEvent({messageName:e,messageId:t})}},r.prototype.registerForTimedoutCalls=function(e){return this.timedoutCallsHandlers.registerHandler(e)},r.prototype.raiseMessageInfoIfNeeded=function(e,t,s,i){if(this.hostNotificationHandlers.HasHandlers()){var n={isToHost:t,isAsync:s,isProxied:i,envelope:e,messageName:e.messageName,isIdRequest:e.isIdRequest,syncId:e.syncId,messageId:e.messageId,isEvent:e.isEvent,isInvokable:e.isInvokable,wasSuccessful:e.wasSuccessful,abandoned:e.abandoned};this.hostNotificationHandlers.RaiseEvent(n)}},r}(),Ee=function(){function r(e){this.bridge=e,this.processor=new J,this.instanceId=null,this.namespaceVersions=new Map;var t=function(i){this.namespaceVersions.has(i)&&this.namespaceVersions.delete(i)}.bind(this);this.processor.registerForNamespaceVersionChange(t);var s=function(i){this.processor.onMessageFromHost(i,this.bridge)}.bind(this);this.bridge.addHostMessageHandler(s)}return r.prototype.getRevision=function(){return H},r.prototype.resetSyncIdsForUnitTests=function(){this.processor.resetSyncIdsForUnitTests()},r.prototype.invokeHost=function(e,t,s){var i=this;return new Promise(function(n,a){i.processor.invokeOnHost(i.bridge,e,t,n,a,s)})},r.prototype.invokeHostSync=function(e,t,s){var i,n=function(d){i=d},a=function(d){throw d};return this.processor.invokeOnHostSync(this.bridge,e,t,n,a,s),i},r.prototype.forwardProxyMessage=function(e){var t=this;return new Promise(function(s){t.processor.forwardProxyMessage(t.bridge,e,s)})},r.prototype.invokeIdRequestOnHost=function(e,t){var s=this;return new Promise(function(i,n){s.processor.invokeIdRequest(s.bridge,e,t,i,n)})},r.prototype.registerForEvent=function(e,t){return this.processor.registerForEvent(e,t)},r.prototype.registerForInvokable=function(e,t){return this.processor.registerForInvokable(e,t)},r.prototype.registerEventForwarder=function(e){return this.processor.registerEventForwarder(e)},r.prototype.registerForAbandonedCalls=function(e){return this.processor.registerForAbandonedCalls(e)},r.prototype.registerForHostMessageNotification=function(e){return this.processor.registerForHostMessageNotification(e)},r.prototype.invokeHostEvent=function(e,t){return this.processor.invokeHostEvent(this.bridge,e,t)},r.prototype.timeoutCall=function(e,t,s){return this.processor.timeoutCall(e,t,s)},r.prototype.registerForTimedoutCalls=function(e){return this.processor.registerForTimedoutCalls(e)},r.prototype.getInstanceId=function(){var e=this;return new Promise(function(t,s){e.instanceId?t(e.instanceId):e.invokeIdRequestOnHost("instance","id").then(function(i){e.instanceId=i,t(e.instanceId)}).catch(function(i){s(i)})})},r.prototype.getNamespaceVersion=function(e){var t=this;return new Promise(function(s,i){if(t.namespaceVersions.has(e)){s(t.namespaceVersions.get(e));return}t.invokeIdRequestOnHost("version",e).then(function(n){var a=parseFloat(n);isNaN(a)?i("Non numeric version returned"):(t.namespaceVersions.set(e,a),s(a))}).catch(function(n){i(n)})})},r}(),R=function(){function r(){}return r.setGlobalPreprocessCheck=function(e){r._globalPreprocessCheck=e},r.getSharedHostBridgeFactory=function(e){return function(t,s){if(s>H)throw new Error("Bridge is not supported. Current "+H+", Requested "+t+", Minimum "+s);return r._sharedHostBridge||(r._sharedHostBridge=new Ee(e)),r._sharedHostBridge}},r.isInitialized=function(){return!!r._implInstance},r.isInitializationNeeded=function(e){return!r._implInstance||r._bridgeFactory!=e},r.initialize=function(e){r.isInitializationNeeded(e)&&(r._bridgeFactory=e,r._implInstance=e(H,pe))},r.resetBridgeForUnitTests=function(){r._implInstance=null,r._bridgeFactory=null,r._sharedHostBridge=null,r._globalPreprocessCheck=null},r.resetSyncIdsForUnitTests=function(){r._implInstance&&r._implInstance.resetSyncIdsForUnitTests()},r.failBridgeNotInitialized=function(){return new Promise(function(e,t){t(new Error("HostBridge not initialized"))})},r.invokeHost=function(e,t,s){return v(this,void 0,void 0,function(){return T(this,function(i){switch(i.label){case 0:return r._implInstance?r._globalPreprocessCheck?[4,r._globalPreprocessCheck(e)]:[3,2]:[3,3];case 1:i.sent(),i.label=2;case 2:return[2,r._implInstance.invokeHost(e,t,s)];case 3:return[2,r.failBridgeNotInitialized()]}})})},r.invokeHostSync=function(e,t,s){if(r._implInstance)return r._implInstance.invokeHostSync(e,t,s);throw new Error("HostBridge not initialized")},r.forwardProxyMessage=function(e){return r._implInstance?r._implInstance.forwardProxyMessage(e):r.failBridgeNotInitialized()},r.getInstanceId=function(){return v(this,void 0,void 0,function(){return T(this,function(e){return r._implInstance?[2,r._implInstance.getInstanceId()]:[2,r.failBridgeNotInitialized()]})})},r.getNamespaceVersion=function(e){return v(this,void 0,void 0,function(){return T(this,function(t){return r._implInstance?[2,r._implInstance.getNamespaceVersion(e)]:[2,r.failBridgeNotInitialized()]})})},r.registerForEvent=function(e,t){return r._implInstance?r._implInstance.registerForEvent(e,t):null},r.registerForInvokable=function(e,t){if(r._implInstance){var s={type:U.Callback,handler:t};return r._implInstance.registerForInvokable(e,s)}return null},r.registerInvokableForwarder=function(e,t){if(r._implInstance){var s={type:U.Forwarder,handler:t};return r._implInstance.registerForInvokable(e,s)}return null},r.registerEventForwarder=function(e){return r._implInstance?r._implInstance.registerEventForwarder(e):null},r.registerForAbandonedCalls=function(e){return r._implInstance?r._implInstance.registerForAbandonedCalls(e):null},r.registerForHostMessageNotification=function(e){return r._implInstance?r._implInstance.registerForHostMessageNotification(e):null},r.invokeHostEvent=function(e,t){var s;if(!((s=r._implInstance)===null||s===void 0?void 0:s.invokeHostEvent))throw new Error("Initialized PIE bridge does not support host events");r._implInstance.invokeHostEvent(e,t)},r.isTimeoutSupported=function(){return!!r._implInstance&&r._implInstance.getRevision()>=Ie&&!!r._implInstance.timeoutCall&&!!r._implInstance.registerForTimedoutCalls},r.timeoutCall=function(e,t,s){var i,n;((i=r._implInstance)===null||i===void 0?void 0:i.timeoutCall)&&((n=r._implInstance)===null||n===void 0||n.timeoutCall(e,t,s))},r.registerForTimedoutCalls=function(e){var t,s;if((t=r._implInstance)===null||t===void 0?void 0:t.registerForTimedoutCalls)return(s=r._implInstance)===null||s===void 0?void 0:s.registerForTimedoutCalls(e)},r.makePieSyncNotSupportedError=function(){return J.makePieSyncNotSupportedError()},r._implInstance=null,r._bridgeFactory=null,r._sharedHostBridge=null,r._globalPreprocessCheck=null,r}();g.HostBridge=R;function ee(){return v(this,void 0,void 0,function(){return T(this,function(r){return[2,new Promise(function(e){R.getInstanceId().then(function(t){e(!!t)}).catch(function(){e(!1)})})]})})}g.isPIEHostPresent=ee;function te(r,e,t){return v(this,void 0,void 0,function(){var s,i;return T(this,function(n){switch(n.label){case 0:return[4,ee()];case 1:return s=n.sent(),s?[4,R.getNamespaceVersion(r)]:[3,3];case 2:if(i=n.sent(),i>=e&&(!t||i<t))return[2,!0];n.label=3;case 3:return[2,!1]}})})}g.IsVersonSupportedByHost=te;function be(r,e,t){return v(this,void 0,void 0,function(){var s,i;return T(this,function(n){switch(n.label){case 0:s=!1,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,te(r,e,t)];case 2:return s=n.sent(),[3,4];case 3:throw i=n.sent(),new Error("VersionNotSupported for "+r+" failed. Inner exception: "+i.message);case 4:if(!s)throw new Error("VersionNotSupported for "+r+": "+e+", "+t);return[2]}})})}g.throwIfVersionIsNotSupported=be});var x=_(P=>{"use strict";Object.defineProperty(P,"__esModule",{value:!0});P.registerForHostMessageNotification=P.isWebView2BridgeInitialized=P.initializeWebView2Bridge=void 0;var C=E(),Ce=function(){function r(){var e=this;this.messageFromHostCallback=function(t){},this.getWebview().addEventListener("message",function(t){e.messageFromHostCallback(t.data)})}return r.prototype.sendMessageToHost=function(e){this.getWebview().postMessage(e)},r.prototype.invokeHostSync=function(e,t){var s="";try{s=e.hostObjects.sync.piehostbridge.invokeSync(JSON.stringify(t))}catch(i){return{success:!1,err:i}}return{success:!0,response:JSON.parse(s)}},r.prototype.sendMessageToHostSync=function(e){var t=this.getWebview();if(t){var s=this.invokeHostSync(t,e);if(s.success){this.messageFromHostCallback(s.response);return}}throw C.HostBridge.makePieSyncNotSupportedError()},r.prototype.getStartingSyncId=function(){var e=this.getWebview();if(e)try{return e.hostObjects.sync.piehostbridge.getStartingSyncId()}catch(t){}throw C.HostBridge.makePieSyncNotSupportedError()},r.prototype.addHostMessageHandler=function(e){this.messageFromHostCallback=e},r.prototype.getWebview=function(){if(typeof window!="object")return null;var e=window.chrome;if(e)return e.webview},r}();function Ue(){window.pieSharedBridgeFactory||(window.pieSharedBridgeFactory=C.HostBridge.getSharedHostBridgeFactory(new Ce)),C.HostBridge.initialize(window.pieSharedBridgeFactory)}P.initializeWebView2Bridge=Ue;function xe(){var r;return!!((r=window)===null||r===void 0?void 0:r.pieSharedBridgeFactory)&&!C.HostBridge.isInitializationNeeded(window.pieSharedBridgeFactory)}P.isWebView2BridgeInitialized=xe;function De(r){return C.HostBridge.registerForHostMessageNotification(r)}P.registerForHostMessageNotification=De});var W=h(x());var G={};S(G,{GetPIEScriptVersion:()=>Be,JsonPostProcessing:()=>p,TrustedLogSeverity:()=>L,writeEntries:()=>Se});var V=h(E());function Be(){return 1.1}var L;(function(r){r.DebugPII="DebugPII",r.Diagnostic="Diagnostic",r.Debug="Debug",r.Info="Info",r.Warning="Warning",r.Error="Error"})(L||(L={}));var p=class{static ArrayOfTrustedLogEntryProcessor(){return p.ArrayOfTrustedLogEntryValue||(p.ArrayOfTrustedLogEntryValue={process:function(e){let t=p.TrustedLogEntryProcessor();for(let s=0;s<e.length;s++)t.process?t.process(e[s]):t.convert&&(e[s]=t.convert(e[s]))}}),p.ArrayOfTrustedLogEntryValue}static TrustedLogSeverityProcessor(){return p.TrustedLogSeverityValue||(p.TrustedLogSeverityValue={convert:function(e){return e}}),p.TrustedLogSeverityValue}static TrustedLogEntryProcessor(){return p.TrustedLogEntryValue||(p.TrustedLogEntryValue={process:function(e){let t=p.TrustedLogSeverityProcessor();t.process?t.process(e.severity):t.convert&&(e.severity=t.convert(e.severity))}}),p.TrustedLogEntryValue}static WriteEntriesParamsProcessor(){return p.WriteEntriesParamsValue||(p.WriteEntriesParamsValue={process:function(e){let t=p.ArrayOfTrustedLogEntryProcessor();t.process?t.process(e.entries):t.convert&&(e.entries=t.convert(e.entries))}}),p.WriteEntriesParamsValue}};async function Se(r){let e={entries:r};return V.HostBridge.invokeHost("loggingtrusted.writeEntries",e,V.NoopPostProcessingFactory())}var re={...G};(0,W.initializeWebView2Bridge)();globalThis.nativeModules={...globalThis.nativeModules,Loggingtrusted:re};var K=h(x());var z={};S(z,{GetPIEScriptVersion:()=>He,JsonPostProcessing:()=>u,createTelemetryContext:()=>Ve,getDdvConnectionState:()=>ke,getDdvEnabled:()=>Ae,logTrustedEvents:()=>we,registerForDdvConnectionStateChanged:()=>Re,registerForOnTelemetryContextReady:()=>Oe,setDdvConnectionString:()=>Me,setDdvEnabled:()=>Ne,setTrustedContext:()=>Fe});var I=h(E());function He(){return 1.2}var u=class{static ArrayOfTrustedTelemetryEventProcessor(){return u.ArrayOfTrustedTelemetryEventValue||(u.ArrayOfTrustedTelemetryEventValue={process:function(e){let t=u.TrustedTelemetryEventProcessor();for(let s=0;s<e.length;s++)t.process?t.process(e[s]):t.convert&&(e[s]=t.convert(e[s]))}}),u.ArrayOfTrustedTelemetryEventValue}static ArrayOfTrustedTelemetryEventPayloadProcessor(){return u.ArrayOfTrustedTelemetryEventPayloadValue||(u.ArrayOfTrustedTelemetryEventPayloadValue={process:function(e){let t=u.TrustedTelemetryEventPayloadProcessor();for(let s=0;s<e.length;s++)t.process?t.process(e[s]):t.convert&&(e[s]=t.convert(e[s]))}}),u.ArrayOfTrustedTelemetryEventPayloadValue}static TelemetryUIContextProcessor(){return{}}static TrustedTelemetryEventPayloadProcessor(){return u.TrustedTelemetryEventPayloadValue||(u.TrustedTelemetryEventPayloadValue={process:function(e){let t=u.ArrayOfTrustedTelemetryEventProcessor();t.process?t.process(e.events):t.convert&&(e.events=t.convert(e.events))}}),u.TrustedTelemetryEventPayloadValue}static TrustedTelemetryEventProcessor(){return{}}static TrustedDdvStateChangedArgsProcessor(){return{}}static CreateTelemetryContextParamsProcessor(){return u.CreateTelemetryContextParamsValue||(u.CreateTelemetryContextParamsValue={process:function(e){let t=u.TelemetryUIContextProcessor();t.process?t.process(e.context):t.convert&&(e.context=t.convert(e.context))}}),u.CreateTelemetryContextParamsValue}static OnTelemetryContextReadyParamsProcessor(){return u.OnTelemetryContextReadyParamsValue||(u.OnTelemetryContextReadyParamsValue={process:function(e){let t=u.TelemetryUIContextProcessor();t.process?t.process(e.context):t.convert&&(e.context=t.convert(e.context))}}),u.OnTelemetryContextReadyParamsValue}static SetTrustedContextParamsProcessor(){return u.SetTrustedContextParamsValue||(u.SetTrustedContextParamsValue={process:function(e){let t=u.TelemetryUIContextProcessor();t.process?t.process(e.uiContext):t.convert&&(e.uiContext=t.convert(e.uiContext));let s=u.ArrayOfTrustedTelemetryEventProcessor();s.process?s.process(e.contexts):s.convert&&(e.contexts=s.convert(e.contexts))}}),u.SetTrustedContextParamsValue}static LogTrustedEventsParamsProcessor(){return u.LogTrustedEventsParamsValue||(u.LogTrustedEventsParamsValue={process:function(e){let t=u.TelemetryUIContextProcessor();t.process?t.process(e.uiContext):t.convert&&(e.uiContext=t.convert(e.uiContext));let s=u.ArrayOfTrustedTelemetryEventPayloadProcessor();s.process?s.process(e.events):s.convert&&(e.events=s.convert(e.events))}}),u.LogTrustedEventsParamsValue}static SetDdvEnabledParamsProcessor(){return{}}static SetDdvConnectionStringParamsProcessor(){return{}}static DdvConnectionStateChangedParamsProcessor(){return u.DdvConnectionStateChangedParamsValue||(u.DdvConnectionStateChangedParamsValue={process:function(e){let t=u.TrustedDdvStateChangedArgsProcessor();t.process?t.process(e.state):t.convert&&(e.state=t.convert(e.state))}}),u.DdvConnectionStateChangedParamsValue}};async function Ve(r){let e={context:r};return I.HostBridge.invokeHost("telemetrytrusted.createTelemetryContext",e,I.NoopPostProcessingFactory())}async function Fe(r,e){let t={uiContext:r,contexts:e};return I.HostBridge.invokeHost("telemetrytrusted.setTrustedContext",t,I.NoopPostProcessingFactory())}async function we(r,e){let t={uiContext:r,events:e};return I.HostBridge.invokeHost("telemetrytrusted.logTrustedEvents",t,I.NoopPostProcessingFactory())}async function Ne(r){let e={enabled:r};return I.HostBridge.invokeHost("telemetrytrusted.setDdvEnabled",e,I.NoopPostProcessingFactory())}async function Me(r){let e={connectionString:r};return I.HostBridge.invokeHost("telemetrytrusted.setDdvConnectionString",e,I.NoopPostProcessingFactory())}async function ke(){return I.HostBridge.invokeHost("telemetrytrusted.getDdvConnectionState",{},I.NoopPostProcessingFactory())}async function Ae(){return I.HostBridge.invokeHost("telemetrytrusted.getDdvEnabled",{},I.NoopPostProcessingFactory())}function Oe(r){let e=function(t){if(t){let s=u.OnTelemetryContextReadyParamsProcessor();s.process?s.process(t):s.convert&&(t=s.convert(t)),r(t.context)}};return I.HostBridge.registerForEvent("telemetrytrusted.onTelemetryContextReady",e)}function Re(r){let e=function(t){if(t){let s=u.DdvConnectionStateChangedParamsProcessor();s.process?s.process(t):s.convert&&(t=s.convert(t)),r(t.state)}};return I.HostBridge.registerForEvent("telemetrytrusted.ddvConnectionStateChanged",e)}var se={...z};(0,K.initializeWebView2Bridge)();globalThis.nativeModules={...globalThis.nativeModules,Telemetrytrusted:se};var Q=h(x());var q={};S(q,{GetPIEScriptVersion:()=>Ge,JsonPostProcessing:()=>y,TestGreeting:()=>X,registerForOnGreetingLauguageChanged:()=>We,sayGreeting:()=>Le});var D=h(E());function Ge(){return 1}var X;(function(r){r.kHello="kHello",r.kHi="kHi"})(X||(X={}));var y=class{static TestGreetingProcessor(){return y.TestGreetingValue||(y.TestGreetingValue={convert:function(e){return e}}),y.TestGreetingValue}static GreetingInfoProcessor(){return y.GreetingInfoValue||(y.GreetingInfoValue={process:function(e){let t=y.TestGreetingProcessor();t.process?t.process(e.greeting):t.convert&&(e.greeting=t.convert(e.greeting))}}),y.GreetingInfoValue}static SayGreetingParamsProcessor(){return y.SayGreetingParamsValue||(y.SayGreetingParamsValue={process:function(e){let t=y.GreetingInfoProcessor();t.process?t.process(e.greet):t.convert&&(e.greet=t.convert(e.greet))}}),y.SayGreetingParamsValue}static OnGreetingLauguageChangedParamsProcessor(){return{}}};async function Le(r){let e={greet:r};return D.HostBridge.invokeHost("testtrusted.sayGreeting",e,D.NoopPostProcessingFactory())}function We(r){let e=function(t){if(t){let s=y.OnGreetingLauguageChangedParamsProcessor();s.process?s.process(t):s.convert&&(t=s.convert(t)),r(t.lang)}};return D.HostBridge.registerForEvent("testtrusted.onGreetingLauguageChanged",e)}var ne={...q};(0,Q.initializeWebView2Bridge)();globalThis.nativeModules={...globalThis.nativeModules,Testtrusted:ne};var j=h(x());var Y={};S(Y,{GetPIEScriptVersion:()=>ze,JsonPostProcessing:()=>o,TUIAvailability:()=>Z,TUINotificationSignal:()=>$,getGlobalUserData:()=>Ke,registerForOnCloudUserDataChange:()=>Xe,registerForOnGlobalUserDataChange:()=>qe});var F=h(E());function ze(){return 1}var Z;(function(r){r.PresenceUnknown="PresenceUnknown",r.Available="Available",r.AvailableIdle="AvailableIdle",r.Away="Away",r.Busy="Busy",r.BusyIdle="BusyIdle",r.DoNotDisturb="DoNotDisturb",r.BeRightBack="BeRightBack",r.Offline="Offline"})(Z||(Z={}));var $;(function(r){r.call="call",r.mention="mention",r.chat="chat",r.channel="channel",r.other="other"})($||($={}));var o=class{static ArrayOfTUISignalItemProcessor(){return o.ArrayOfTUISignalItemValue||(o.ArrayOfTUISignalItemValue={process:function(e){let t=o.TUISignalItemProcessor();for(let s=0;s<e.length;s++)t.process?t.process(e[s]):t.convert&&(e[s]=t.convert(e[s]))}}),o.ArrayOfTUISignalItemValue}static ArrayOfTUITenantInfoDataProcessor(){return o.ArrayOfTUITenantInfoDataValue||(o.ArrayOfTUITenantInfoDataValue={process:function(e){let t=o.TUITenantInfoDataProcessor();for(let s=0;s<e.length;s++)t.process?t.process(e[s]):t.convert&&(e[s]=t.convert(e[s]))}}),o.ArrayOfTUITenantInfoDataValue}static ArrayOfTUICloudUserDataProcessor(){return o.ArrayOfTUICloudUserDataValue||(o.ArrayOfTUICloudUserDataValue={process:function(e){let t=o.TUICloudUserDataProcessor();for(let s=0;s<e.length;s++)t.process?t.process(e[s]):t.convert&&(e[s]=t.convert(e[s]))}}),o.ArrayOfTUICloudUserDataValue}static TUIAvailabilityProcessor(){return o.TUIAvailabilityValue||(o.TUIAvailabilityValue={convert:function(e){return e}}),o.TUIAvailabilityValue}static TUINotificationSignalProcessor(){return o.TUINotificationSignalValue||(o.TUINotificationSignalValue={convert:function(e){return e}}),o.TUINotificationSignalValue}static TUIProfileDataProcessor(){return{}}static TUIPresenceDataProcessor(){return o.TUIPresenceDataValue||(o.TUIPresenceDataValue={process:function(e){let t=o.TUIAvailabilityProcessor();t.process?t.process(e.availability):t.convert&&(e.availability=t.convert(e.availability))}}),o.TUIPresenceDataValue}static TUISignalItemProcessor(){return o.TUISignalItemValue||(o.TUISignalItemValue={process:function(e){let t=o.TUINotificationSignalProcessor();t.process?t.process(e.signal):t.convert&&(e.signal=t.convert(e.signal))}}),o.TUISignalItemValue}static TUIUnreadNotificationSignalsProcessor(){return o.TUIUnreadNotificationSignalsValue||(o.TUIUnreadNotificationSignalsValue={process:function(e){let t=o.ArrayOfTUISignalItemProcessor();t.process?t.process(e.signalsList):t.convert&&(e.signalsList=t.convert(e.signalsList));let s=e.mostRecentNotificationSignal===void 0?{}:o.TUINotificationSignalProcessor();s.process?s.process(e.mostRecentNotificationSignal):s.convert&&(e.mostRecentNotificationSignal=s.convert(e.mostRecentNotificationSignal))}}),o.TUIUnreadNotificationSignalsValue}static TUIMissedNotificationDataProcessor(){return o.TUIMissedNotificationDataValue||(o.TUIMissedNotificationDataValue={process:function(e){let t=o.TUIUnreadNotificationSignalsProcessor();t.process?t.process(e.unreadNotificationSignals):t.convert&&(e.unreadNotificationSignals=t.convert(e.unreadNotificationSignals))}}),o.TUIMissedNotificationDataValue}static TUIAuthenticationUserProfileDataProcessor(){return{}}static TUIAuthenticationUserDataProcessor(){return o.TUIAuthenticationUserDataValue||(o.TUIAuthenticationUserDataValue={process:function(e){let t=o.TUIAuthenticationUserProfileDataProcessor();t.process?t.process(e.profile):t.convert&&(e.profile=t.convert(e.profile))}}),o.TUIAuthenticationUserDataValue}static TUIUserAccountAuthStateDataProcessor(){return{}}static TUITenantInfoDataProcessor(){return{}}static TUIProfilePictureDataProcessor(){return{}}static TUILoggedOutStateDataProcessor(){return{}}static TUICloudUserDataProcessor(){return o.TUICloudUserDataValue||(o.TUICloudUserDataValue={process:function(e){let t=o.TUIProfileDataProcessor();t.process?t.process(e.profileData):t.convert&&(e.profileData=t.convert(e.profileData));let s=o.TUIPresenceDataProcessor();s.process?s.process(e.presenceData):s.convert&&(e.presenceData=s.convert(e.presenceData));let i=o.TUIMissedNotificationDataProcessor();i.process?i.process(e.missedNotificationData):i.convert&&(e.missedNotificationData=i.convert(e.missedNotificationData));let n=o.TUIAuthenticationUserDataProcessor();n.process?n.process(e.authenticationUserData):n.convert&&(e.authenticationUserData=n.convert(e.authenticationUserData));let a=o.TUIUserAccountAuthStateDataProcessor();a.process?a.process(e.userAccountAuthStateData):a.convert&&(e.userAccountAuthStateData=a.convert(e.userAccountAuthStateData));let d=o.ArrayOfTUITenantInfoDataProcessor();d.process?d.process(e.tenantInfoData):d.convert&&(e.tenantInfoData=d.convert(e.tenantInfoData));let f=o.TUIProfilePictureDataProcessor();f.process?f.process(e.profilePictureData):f.convert&&(e.profilePictureData=f.convert(e.profilePictureData));let c=o.TUILoggedOutStateDataProcessor();c.process?c.process(e.loggedOutStateData):c.convert&&(e.loggedOutStateData=c.convert(e.loggedOutStateData))}}),o.TUICloudUserDataValue}static TUIGlobalUserDataProcessor(){return o.TUIGlobalUserDataValue||(o.TUIGlobalUserDataValue={process:function(e){let t=o.ArrayOfTUICloudUserDataProcessor();t.process?t.process(e.aggregatedCloudUserData):t.convert&&(e.aggregatedCloudUserData=t.convert(e.aggregatedCloudUserData))}}),o.TUIGlobalUserDataValue}static OnGlobalUserDataChangeParamsProcessor(){return o.OnGlobalUserDataChangeParamsValue||(o.OnGlobalUserDataChangeParamsValue={process:function(e){let t=o.TUIGlobalUserDataProcessor();t.process?t.process(e.data):t.convert&&(e.data=t.convert(e.data))}}),o.OnGlobalUserDataChangeParamsValue}static OnCloudUserDataChangeParamsProcessor(){return o.OnCloudUserDataChangeParamsValue||(o.OnCloudUserDataChangeParamsValue={process:function(e){let t=o.ArrayOfTUICloudUserDataProcessor();t.process?t.process(e.data):t.convert&&(e.data=t.convert(e.data))}}),o.OnCloudUserDataChangeParamsValue}};async function Ke(){return F.HostBridge.invokeHost("userdataxcloudtrusted.getGlobalUserData",{},o.TUIGlobalUserDataProcessor())}function qe(r){let e=function(t){if(t){let s=o.OnGlobalUserDataChangeParamsProcessor();s.process?s.process(t):s.convert&&(t=s.convert(t)),r(t.data)}};return F.HostBridge.registerForEvent("userdataxcloudtrusted.onGlobalUserDataChange",e)}function Xe(r){let e=function(t){if(t){let s=o.OnCloudUserDataChangeParamsProcessor();s.process?s.process(t):s.convert&&(t=s.convert(t)),r(t.data)}};return F.HostBridge.registerForEvent("userdataxcloudtrusted.onCloudUserDataChange",e)}var ie={...Y};(0,j.initializeWebView2Bridge)();globalThis.nativeModules={...globalThis.nativeModules,Userdataxcloudtrusted:ie};var oe=h(E());((r,e)=>{r.enablePIEMonitor=function(i=!1){t||(t=new s),!t.enabled&&t.enable(i)},r.disablePIEMonitor=function(){!t||!t.enabled||t.disable()};var t=null;class s{constructor(){this.enabled=!1;this.iteration=0;this.unregisterHostNotificationCallback=null}enable(n){console.log("[PIE Monitor] Enabling PIE Monitor!"),this.expandedLogging=n,this.enabled=!0,this.unregisterHostNotificationCallback=this.registerPIEMonitorCallback()}disable(){console.log("[PIE Monitor] Disabling PIE Monitor!"),this.enabled=!1,this.unregisterHostNotificationCallback(),this.writeSessionStorageToJsonFile()}registerPIEMonitorCallback(){return console.log("[PIE Monitor] Registering callback."),oe.HostBridge.registerForHostMessageNotification(a=>this.onMessage(a))}onMessage(n){let a=Date.now(),d="pie-monitor-entry-"+this.iteration.toString(),f;this.expandedLogging?f={timestamp:a,...n}:f={timestamp:a,messageName:n.messageName,messageId:n.messageId,syncId:n.syncId,isToHost:n.isToHost,isAsync:n.isAsync,isEvent:n.isEvent},sessionStorage.setItem(d,JSON.stringify(f)),this.iteration++}writeSessionStorageToJsonFile(){console.log("[PIE Monitor] Writing sessionStorage to json file.");var n=[];for(let[c,l]of Object.entries(sessionStorage))c.includes("pie-monitor-entry")&&n.push(JSON.parse(l));n=n.sort((c,l)=>c.timestamp-l.timestamp);let a=e.createElement("a"),d="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(n));a.setAttribute("href",d);let f=new Date().toISOString()+"-PIEMonitorRawData.json";a.setAttribute("download",f),e.body.appendChild(a),a.click(),a.remove(),sessionStorage.clear()}}})(window,document);})();
