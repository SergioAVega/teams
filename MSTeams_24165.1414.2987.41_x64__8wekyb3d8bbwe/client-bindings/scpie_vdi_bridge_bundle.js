!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("scpie-vdi-bridge",[],n):"object"==typeof exports?exports["scpie-vdi-bridge"]=n():e["scpie-vdi-bridge"]=n()}(this,(function(){return function(){"use strict";var e={911:function(e,n){var t=this&&this.__awaiter||function(e,n,t,r){return new(t||(t=Promise))((function(o,s){function i(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,a)}c((r=r.apply(e,n||[])).next())}))},r=this&&this.__generator||function(e,n){var t,r,o,s,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,r=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){i.label=s[1];break}if(6===s[0]&&i.label<o[1]){i.label=o[1],o=s;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(s);break}o[2]&&i.ops.pop(),i.trys.pop();continue}s=n.call(e,i)}catch(e){s=[6,e],r=0}finally{t=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}};Object.defineProperty(n,"__esModule",{value:!0}),n.throwIfVersionIsNotSupported=n.IsVersonSupportedByHost=n.isPIEHostPresent=n.HostBridge=n.NoopPostProcessingFactory=n.Uint8ArrayPostProcessingFactory=n.PointerPostProcessingFactory=n.DatePostProcessingFactory=void 0;var o,s,i,a;function c(e){throw new Error("Resolve must not be called")}function d(e){throw new Error("Reject must not be called")}n.DatePostProcessingFactory=function(){return o||(o={convert:function(e){return new Date(e)}}),o},n.PointerPostProcessingFactory=function(){return s||(s={convert:function(e){return new Uint32Array([e[0],e[1]])}}),s},n.Uint8ArrayPostProcessingFactory=function(){return i||(i={convert:function(e){return new Uint8Array(e)}}),i},n.NoopPostProcessingFactory=function(){return a||(a={}),a};var u,l=function(){function e(){this.nextHandlerId=1,this.registeredHandlers=new Map}return e.prototype.registerHandler=function(e){var n=this,t=this.nextHandlerId;return this.nextHandlerId=this.nextHandlerId+1,this.registeredHandlers.set(t,e),function(){n.unregisterHandler(t)}},e.prototype.RaiseEvent=function(e){this.registeredHandlers.forEach((function(n){n(e)}))},e.prototype.HasHandlers=function(){return 0!==this.registeredHandlers.size},e.prototype.unregisterHandler=function(e){this.registeredHandlers.has(e)&&this.registeredHandlers.delete(e)},e}();!function(e){e[e.Callback=0]="Callback",e[e.Forwarder=1]="Forwarder"}(u||(u={}));var g=function(){function e(){this.nextMessageId=1,this.pendingMessages=new Map,this.eventHandlers=new Map,this.invokeHandlers=new Map,this.eventForwarders=new l,this.abandonedCallHandlers=new l,this.namespaceVersionChangeHandlers=new l,this.hostNotificationHandlers=new l,this.firstSyncIdCall=!0,this.timedoutCallsHandlers=new l,this.nextSyncId=1,this.maxMessageId=1073741823}return e.prototype.resetSyncIdsForUnitTests=function(){this.firstSyncIdCall=!0,this.nextSyncId=1},e.prototype.isNamespaceVersionChange=function(e){return e.isIdRequest&&"version-change"===e.messageName&&-3===e.messageId},e.prototype.sendMessageToHost=function(e,n,t){this.raiseMessageInfoIfNeeded(n,!0,!0,t),e.sendMessageToHost(n)},e.prototype.sendMessageToHostSync=function(e,n,t){this.raiseMessageInfoIfNeeded(n,!0,!1,t),e.sendMessageToHostSync(n)},e.prototype.handleInvokableCall=function(e,n){return t(this,void 0,void 0,(function(){var t,o,s,i,a,c;return r(this,(function(r){switch(r.label){case 0:if(t=function(t){var r={wasSuccessful:!0,result:null!=t?t:{}},o={contentType:"app/pie",messageName:e.messageName,messageId:e.messageId,isInvokable:!0,message:r};this.sendMessageToHost(n,o)}.bind(this),o=function(t){var r={wasSuccessful:!1,errorMessage:t.message},o={contentType:"app/pie",messageName:e.messageName,messageId:e.messageId,isInvokable:!0,message:r};this.sendMessageToHost(n,o)}.bind(this),!(s=this.invokeHandlers.get(e.messageName)))return[3,7];if(s.type!==u.Callback)return[3,5];i=s.handler,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i(e.message)];case 2:return a=r.sent(),t(a),[3,4];case 3:return c=r.sent(),o(c),[3,4];case 4:return[3,6];case 5:(0,s.handler)(e),r.label=6;case 6:return[3,8];case 7:o(new Error("No invoke handler registered")),r.label=8;case 8:return[2]}}))}))},e.prototype.onMessageFromHost=function(e,n){var t,r;if("app/pie"===(null==e?void 0:e.contentType))if(this.raiseMessageInfoIfNeeded(e,!1,void 0===(null==e?void 0:e.syncId)),e.isEvent){var o=e.messageName;this.eventHandlers.has(o)&&this.eventHandlers.get(o).RaiseEvent(e.args),this.eventForwarders.RaiseEvent(e)}else if(e.isInvokable)this.handleInvokableCall(e,n);else{var s=e.messageId;if(this.pendingMessages.has(s)){var i=this.pendingMessages.get(s);this.pendingMessages.delete(s),i.proxyHandler?i.proxyHandler(e):e.abandoned?this.abandonedCallHandlers.RaiseEvent(e.messageName):e.wasSuccessful?((null===(t=i.postProcessing)||void 0===t?void 0:t.process)&&i.postProcessing.process(e.message),i.resolve((null===(r=i.postProcessing)||void 0===r?void 0:r.convert)?i.postProcessing.convert(e.message):e.message)):i.reject(new Error(e.messageName+":"+e.errorMessage))}else this.isNamespaceVersionChange(e)&&this.namespaceVersionChangeHandlers.RaiseEvent(e.message)}},e.prototype.addMessageToPendingMessages=function(e,n,t,r){var o=this.nextMessageId;this.nextMessageId=this.nextMessageId===this.maxMessageId?1:this.nextMessageId+1;var s={resolve:e,reject:n,postProcessing:t,proxyHandler:r};return this.pendingMessages.set(o,s),o},e.prototype.invokeIdRequest=function(e,n,t,r,o){var s={contentType:"app/pie",messageName:n,isIdRequest:!0,messageId:this.addMessageToPendingMessages(r,o),message:t};this.sendMessageToHost(e,s)},e.makePieSyncNotSupportedError=function(){return new Error("Synchronous bridge not supported")},e.prototype.getNextSyncId=function(e){this.firstSyncIdCall&&(this.nextSyncId=e.getStartingSyncId(),this.firstSyncIdCall=!1);var n=this.nextSyncId;return this.nextSyncId=this.nextSyncId===Number.MAX_SAFE_INTEGER?1:this.nextSyncId+1,n},e.prototype.invokeOnHostSync=function(n,t,r,o,s,i){if(!n.sendMessageToHostSync)throw e.makePieSyncNotSupportedError();var a=this.addMessageToPendingMessages(o,s,i),c={contentType:"app/pie",messageName:t,syncId:this.getNextSyncId(n),messageId:a,message:r};this.sendMessageToHostSync(n,c)},e.prototype.invokeOnHost=function(e,n,t,r,o,s){var i={contentType:"app/pie",messageName:n,messageId:this.addMessageToPendingMessages(r,o,s),message:t};this.sendMessageToHost(e,i)},e.prototype.forwardProxyMessage=function(e,n,t){if("app/pie"===(null==n?void 0:n.contentType)){if(n.isInvokable)return this.sendMessageToHost(e,n),void t(null);var r=n.messageId,o=this.addMessageToPendingMessages(c,d,void 0,(function(e){e.messageId=r,t(e)}));n.messageId=o,this.sendMessageToHost(e,n,!0)}else t(null)},e.prototype.registerForEvent=function(e,n){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new l),this.eventHandlers.get(e).registerHandler(n)},e.prototype.registerForInvokable=function(e,n){var t=this;if(this.invokeHandlers.has(e))throw new Error("A handler for invokable "+e+" is already registerd");return this.invokeHandlers.set(e,n),function(){t.invokeHandlers.delete(e)}},e.prototype.registerEventForwarder=function(e){return this.eventForwarders.registerHandler(e)},e.prototype.registerForAbandonedCalls=function(e){return this.abandonedCallHandlers.registerHandler(e)},e.prototype.registerForNamespaceVersionChange=function(e){return this.namespaceVersionChangeHandlers.registerHandler(e)},e.prototype.registerForHostMessageNotification=function(e){return this.hostNotificationHandlers.registerHandler(e)},e.prototype.invokeHostEvent=function(e,n,t){var r={contentType:"app/pie",messageName:n,isEvent:!0,message:t};this.sendMessageToHost(e,r)},e.prototype.timeoutCall=function(e,n,t){if(this.pendingMessages.has(n)){var r=e+":"+t,o=this.pendingMessages.get(n);if(this.pendingMessages.delete(n),o.proxyHandler){var s={contentType:"app/pie",messageName:e,messageId:n,wasSuccessful:!1,errorMessage:r};o.proxyHandler(s)}else o.reject(new Error(r)),this.timedoutCallsHandlers.RaiseEvent({messageName:e,messageId:n})}},e.prototype.registerForTimedoutCalls=function(e){return this.timedoutCallsHandlers.registerHandler(e)},e.prototype.raiseMessageInfoIfNeeded=function(e,n,t,r){if(this.hostNotificationHandlers.HasHandlers()){var o={isToHost:n,isAsync:t,isProxied:r,envelope:e,messageName:e.messageName,isIdRequest:e.isIdRequest,syncId:e.syncId,messageId:e.messageId,isEvent:e.isEvent,isInvokable:e.isInvokable,wasSuccessful:e.wasSuccessful,abandoned:e.abandoned};this.hostNotificationHandlers.RaiseEvent(o)}},e}(),p=function(){function e(e){this.bridge=e,this.processor=new g,this.instanceId=null,this.namespaceVersions=new Map;var n=function(e){this.namespaceVersions.has(e)&&this.namespaceVersions.delete(e)}.bind(this);this.processor.registerForNamespaceVersionChange(n);var t=function(e){this.processor.onMessageFromHost(e,this.bridge)}.bind(this);this.bridge.addHostMessageHandler(t)}return e.prototype.getRevision=function(){return 2},e.prototype.resetSyncIdsForUnitTests=function(){this.processor.resetSyncIdsForUnitTests()},e.prototype.invokeHost=function(e,n,t){var r=this;return new Promise((function(o,s){r.processor.invokeOnHost(r.bridge,e,n,o,s,t)}))},e.prototype.invokeHostSync=function(e,n,t){var r;return this.processor.invokeOnHostSync(this.bridge,e,n,(function(e){r=e}),(function(e){throw e}),t),r},e.prototype.forwardProxyMessage=function(e){var n=this;return new Promise((function(t){n.processor.forwardProxyMessage(n.bridge,e,t)}))},e.prototype.invokeIdRequestOnHost=function(e,n){var t=this;return new Promise((function(r,o){t.processor.invokeIdRequest(t.bridge,e,n,r,o)}))},e.prototype.registerForEvent=function(e,n){return this.processor.registerForEvent(e,n)},e.prototype.registerForInvokable=function(e,n){return this.processor.registerForInvokable(e,n)},e.prototype.registerEventForwarder=function(e){return this.processor.registerEventForwarder(e)},e.prototype.registerForAbandonedCalls=function(e){return this.processor.registerForAbandonedCalls(e)},e.prototype.registerForHostMessageNotification=function(e){return this.processor.registerForHostMessageNotification(e)},e.prototype.invokeHostEvent=function(e,n){return this.processor.invokeHostEvent(this.bridge,e,n)},e.prototype.timeoutCall=function(e,n,t){return this.processor.timeoutCall(e,n,t)},e.prototype.registerForTimedoutCalls=function(e){return this.processor.registerForTimedoutCalls(e)},e.prototype.getInstanceId=function(){var e=this;return new Promise((function(n,t){e.instanceId?n(e.instanceId):e.invokeIdRequestOnHost("instance","id").then((function(t){e.instanceId=t,n(e.instanceId)})).catch((function(e){t(e)}))}))},e.prototype.getNamespaceVersion=function(e){var n=this;return new Promise((function(t,r){n.namespaceVersions.has(e)?t(n.namespaceVersions.get(e)):n.invokeIdRequestOnHost("version",e).then((function(o){var s=parseFloat(o);isNaN(s)?r("Non numeric version returned"):(n.namespaceVersions.set(e,s),t(s))})).catch((function(e){r(e)}))}))},e}(),f=function(){function e(){}return e.setGlobalPreprocessCheck=function(n){e._globalPreprocessCheck=n},e.getSharedHostBridgeFactory=function(n){return function(t,r){if(r>2)throw new Error("Bridge is not supported. Current 2, Requested "+t+", Minimum "+r);return e._sharedHostBridge||(e._sharedHostBridge=new p(n)),e._sharedHostBridge}},e.isInitialized=function(){return!!e._implInstance},e.isInitializationNeeded=function(n){return!e._implInstance||e._bridgeFactory!=n},e.initialize=function(n){e.isInitializationNeeded(n)&&(e._bridgeFactory=n,e._implInstance=n(2,1))},e.resetBridgeForUnitTests=function(){e._implInstance=null,e._bridgeFactory=null,e._sharedHostBridge=null,e._globalPreprocessCheck=null},e.resetSyncIdsForUnitTests=function(){e._implInstance&&e._implInstance.resetSyncIdsForUnitTests()},e.failBridgeNotInitialized=function(){return new Promise((function(e,n){n(new Error("HostBridge not initialized"))}))},e.invokeHost=function(n,o,s){return t(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return e._implInstance?e._globalPreprocessCheck?[4,e._globalPreprocessCheck(n)]:[3,2]:[3,3];case 1:t.sent(),t.label=2;case 2:return[2,e._implInstance.invokeHost(n,o,s)];case 3:return[2,e.failBridgeNotInitialized()]}}))}))},e.invokeHostSync=function(n,t,r){if(e._implInstance)return e._implInstance.invokeHostSync(n,t,r);throw new Error("HostBridge not initialized")},e.forwardProxyMessage=function(n){return e._implInstance?e._implInstance.forwardProxyMessage(n):e.failBridgeNotInitialized()},e.getInstanceId=function(){return t(this,void 0,void 0,(function(){return r(this,(function(n){return e._implInstance?[2,e._implInstance.getInstanceId()]:[2,e.failBridgeNotInitialized()]}))}))},e.getNamespaceVersion=function(n){return t(this,void 0,void 0,(function(){return r(this,(function(t){return e._implInstance?[2,e._implInstance.getNamespaceVersion(n)]:[2,e.failBridgeNotInitialized()]}))}))},e.registerForEvent=function(n,t){return e._implInstance?e._implInstance.registerForEvent(n,t):null},e.registerForInvokable=function(n,t){if(e._implInstance){var r={type:u.Callback,handler:t};return e._implInstance.registerForInvokable(n,r)}return null},e.registerInvokableForwarder=function(n,t){if(e._implInstance){var r={type:u.Forwarder,handler:t};return e._implInstance.registerForInvokable(n,r)}return null},e.registerEventForwarder=function(n){return e._implInstance?e._implInstance.registerEventForwarder(n):null},e.registerForAbandonedCalls=function(n){return e._implInstance?e._implInstance.registerForAbandonedCalls(n):null},e.registerForHostMessageNotification=function(n){return e._implInstance?e._implInstance.registerForHostMessageNotification(n):null},e.invokeHostEvent=function(n,t){var r;if(!(null===(r=e._implInstance)||void 0===r?void 0:r.invokeHostEvent))throw new Error("Initialized PIE bridge does not support host events");e._implInstance.invokeHostEvent(n,t)},e.isTimeoutSupported=function(){return!!e._implInstance&&e._implInstance.getRevision()>=2&&!!e._implInstance.timeoutCall&&!!e._implInstance.registerForTimedoutCalls},e.timeoutCall=function(n,t,r){var o,s;(null===(o=e._implInstance)||void 0===o?void 0:o.timeoutCall)&&(null===(s=e._implInstance)||void 0===s||s.timeoutCall(n,t,r))},e.registerForTimedoutCalls=function(n){var t,r;if(null===(t=e._implInstance)||void 0===t?void 0:t.registerForTimedoutCalls)return null===(r=e._implInstance)||void 0===r?void 0:r.registerForTimedoutCalls(n)},e.makePieSyncNotSupportedError=function(){return g.makePieSyncNotSupportedError()},e._implInstance=null,e._bridgeFactory=null,e._sharedHostBridge=null,e._globalPreprocessCheck=null,e}();function v(){return t(this,void 0,void 0,(function(){return r(this,(function(e){return[2,new Promise((function(e){f.getInstanceId().then((function(n){e(!!n)})).catch((function(){e(!1)}))}))]}))}))}function h(e,n,o){return t(this,void 0,void 0,(function(){var t;return r(this,(function(r){switch(r.label){case 0:return[4,v()];case 1:return r.sent()?[4,f.getNamespaceVersion(e)]:[3,3];case 2:if((t=r.sent())>=n&&(!o||t<o))return[2,!0];r.label=3;case 3:return[2,!1]}}))}))}n.HostBridge=f,n.isPIEHostPresent=v,n.IsVersonSupportedByHost=h,n.throwIfVersionIsNotSupported=function(e,n,o){return t(this,void 0,void 0,(function(){var t,s;return r(this,(function(r){switch(r.label){case 0:t=!1,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,h(e,n,o)];case 2:return t=r.sent(),[3,4];case 3:throw s=r.sent(),new Error("VersionNotSupported for "+e+" failed. Inner exception: "+s.message);case 4:if(!t)throw new Error("VersionNotSupported for "+e+": "+n+", "+o);return[2]}}))}))}},956:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.registerForHostMessageNotification=n.isWebView2BridgeInitialized=n.initializeWebView2Bridge=void 0;var r=t(911),o=function(){function e(){var e=this;this.messageFromHostCallback=function(e){},this.getWebview().addEventListener("message",(function(n){e.messageFromHostCallback(n.data)}))}return e.prototype.sendMessageToHost=function(e){this.getWebview().postMessage(e)},e.prototype.invokeHostSync=function(e,n){var t="";try{t=e.hostObjects.sync.piehostbridge.invokeSync(JSON.stringify(n))}catch(e){return{success:!1,err:e}}return{success:!0,response:JSON.parse(t)}},e.prototype.sendMessageToHostSync=function(e){var n=this.getWebview();if(n){var t=this.invokeHostSync(n,e);if(t.success)return void this.messageFromHostCallback(t.response)}throw r.HostBridge.makePieSyncNotSupportedError()},e.prototype.getStartingSyncId=function(){var e=this.getWebview();if(e)try{return e.hostObjects.sync.piehostbridge.getStartingSyncId()}catch(e){}throw r.HostBridge.makePieSyncNotSupportedError()},e.prototype.addHostMessageHandler=function(e){this.messageFromHostCallback=e},e.prototype.getWebview=function(){if("object"!=typeof window)return null;var e=window.chrome;return e?e.webview:void 0},e}();n.initializeWebView2Bridge=function(){window.pieSharedBridgeFactory||(window.pieSharedBridgeFactory=r.HostBridge.getSharedHostBridgeFactory(new o)),r.HostBridge.initialize(window.pieSharedBridgeFactory)},n.isWebView2BridgeInitialized=function(){var e;return!!(null===(e=window)||void 0===e?void 0:e.pieSharedBridgeFactory)&&!r.HostBridge.isInitializationNeeded(window.pieSharedBridgeFactory)},n.registerForHostMessageNotification=function(e){return r.HostBridge.registerForHostMessageNotification(e)}},996:function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SLIMCORE_VERSION=void 0,n.SLIMCORE_VERSION="2024.23.1.23"},627:function(e,n,t){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},r.apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0}),n.PIE2API_DisconnectedArgs=n.PIE2API_ConnectedArgs=void 0;var o=t(646);n.PIE2API_ConnectedArgs=function(e){return r(r({},e),{vendorType:e.vendorType,optssState:e.optssState})},n.PIE2API_DisconnectedArgs=function(e){return r(r({},e),{reason:e.reason,reasonEx:o.DisconnectionReason[e.reason]})}},646:function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.registerForFromHost=n.registerForOnTelemetry=n.registerForOnDisconnected=n.registerForOnDownloadingSlimCore=n.registerForOnConnected=n.GetStartingSyncId=n.ToHostSync=n.ToHost=n.Stop=n.Start=n.JsonPostProcessing=n.DisconnectionReason=n.VendorType=n.GetPIEScriptVersion=void 0;var r=t(911);n.GetPIEScriptVersion=function(){return 1.3},function(e){e[e.Unknown=0]="Unknown",e[e.Citrix=1]="Citrix",e[e.VMWare=3]="VMWare",e[e.AVD=5]="AVD",e[e.Amazon=7]="Amazon"}(n.VendorType||(n.VendorType={})),function(e){e[e.Generic=0]="Generic",e[e.ClientWatchdog=1]="ClientWatchdog",e[e.BrokenSlimCore=2]="BrokenSlimCore",e[e.VmWatchdog=3]="VmWatchdog"}(n.DisconnectionReason||(n.DisconnectionReason={}));var o=function(){function e(){}return e.ArrayOfStringProcessor=function(){return{}},e.VendorTypeProcessor=function(){return e.VendorTypeValue||(e.VendorTypeValue={convert:function(e){return e}}),e.VendorTypeValue},e.DisconnectionReasonProcessor=function(){return e.DisconnectionReasonValue||(e.DisconnectionReasonValue={convert:function(e){return e}}),e.DisconnectionReasonValue},e.VoidResultProcessor=function(){return{}},e.BridgeConnectedArgsProcessor=function(){return e.BridgeConnectedArgsValue||(e.BridgeConnectedArgsValue={process:function(n){var t=e.VendorTypeProcessor();t.process?t.process(n.vendorType):t.convert&&(n.vendorType=t.convert(n.vendorType))}}),e.BridgeConnectedArgsValue},e.BridgeDisconnectedArgsProcessor=function(){return e.BridgeDisconnectedArgsValue||(e.BridgeDisconnectedArgsValue={process:function(n){var t=e.DisconnectionReasonProcessor();t.process?t.process(n.reason):t.convert&&(n.reason=t.convert(n.reason))}}),e.BridgeDisconnectedArgsValue},e.BridgeDownloadingSlimCoreArgsProcessor=function(){return{}},e.TelemetryOptionsProcessor=function(){return{}},e.BridgeOptionsProcessor=function(){return e.BridgeOptionsValue||(e.BridgeOptionsValue={process:function(n){var t=void 0===n.telemetryOptions?{}:e.TelemetryOptionsProcessor();t.process?t.process(n.telemetryOptions):t.convert&&(n.telemetryOptions=t.convert(n.telemetryOptions))}}),e.BridgeOptionsValue},e.StartParamsProcessor=function(){return e.StartParamsValue||(e.StartParamsValue={process:function(n){var t=e.BridgeOptionsProcessor();t.process?t.process(n.options):t.convert&&(n.options=t.convert(n.options))}}),e.StartParamsValue},e.OnConnectedParamsProcessor=function(){return e.OnConnectedParamsValue||(e.OnConnectedParamsValue={process:function(n){var t=e.BridgeConnectedArgsProcessor();t.process?t.process(n.args):t.convert&&(n.args=t.convert(n.args))}}),e.OnConnectedParamsValue},e.OnDownloadingSlimCoreParamsProcessor=function(){return e.OnDownloadingSlimCoreParamsValue||(e.OnDownloadingSlimCoreParamsValue={process:function(n){var t=e.BridgeDownloadingSlimCoreArgsProcessor();t.process?t.process(n.args):t.convert&&(n.args=t.convert(n.args))}}),e.OnDownloadingSlimCoreParamsValue},e.OnDisconnectedParamsProcessor=function(){return e.OnDisconnectedParamsValue||(e.OnDisconnectedParamsValue={process:function(n){var t=e.BridgeDisconnectedArgsProcessor();t.process?t.process(n.args):t.convert&&(n.args=t.convert(n.args))}}),e.OnDisconnectedParamsValue},e.OnTelemetryParamsProcessor=function(){return{}},e.ToHostSyncParamsProcessor=function(){return{}},e.FromHostParamsProcessor=function(){return{}},e}();n.JsonPostProcessing=o,n.Start=function(e){var n={options:e};return r.HostBridge.invokeHostSync("vdiwv2.Start",n,o.VoidResultProcessor())},n.Stop=function(){return r.HostBridge.invokeHostSync("vdiwv2.Stop",{},o.VoidResultProcessor())},n.ToHost=function(e){var n={message:e};return r.HostBridge.invokeHostEvent("vdiwv2.ToHost",n)},n.ToHostSync=function(e){var n={message:e};return r.HostBridge.invokeHostSync("vdiwv2.ToHostSync",n,r.NoopPostProcessingFactory())},n.GetStartingSyncId=function(){return r.HostBridge.invokeHostSync("vdiwv2.GetStartingSyncId",{},r.NoopPostProcessingFactory())},n.registerForOnConnected=function(e){return r.HostBridge.registerForEvent("vdiwv2.OnConnected",(function(n){if(n){var t=o.OnConnectedParamsProcessor();t.process?t.process(n):t.convert&&(n=t.convert(n)),e(n.args)}}))},n.registerForOnDownloadingSlimCore=function(e){return r.HostBridge.registerForEvent("vdiwv2.OnDownloadingSlimCore",(function(n){if(n){var t=o.OnDownloadingSlimCoreParamsProcessor();t.process?t.process(n):t.convert&&(n=t.convert(n)),e(n.args)}}))},n.registerForOnDisconnected=function(e){return r.HostBridge.registerForEvent("vdiwv2.OnDisconnected",(function(n){if(n){var t=o.OnDisconnectedParamsProcessor();t.process?t.process(n):t.convert&&(n=t.convert(n)),e(n.args)}}))},n.registerForOnTelemetry=function(e){return r.HostBridge.registerForEvent("vdiwv2.OnTelemetry",(function(n){if(n){var t=o.OnTelemetryParamsProcessor();t.process?t.process(n):t.convert&&(n=t.convert(n)),e(n.data)}}))},n.registerForFromHost=function(e){return r.HostBridge.registerForEvent("vdiwv2.FromHost",(function(n){if(n){var t=o.FromHostParamsProcessor();t.process?t.process(n):t.convert&&(n=t.convert(n)),e(n.message)}}))}}},n={};function t(r){var o=n[r];if(void 0!==o)return o.exports;var s=n[r]={exports:{}};return e[r].call(s.exports,s,s.exports,t),s.exports}var r={};return function(){var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.makeBridge=void 0;var n=t(996),o=t(956),s=t(646),i=t(627),a=window.chrome&&window.chrome.webview,c=null;a&&(o.initializeWebView2Bridge(),globalThis.V8Bridge_ToHost=function(e){s.ToHost(e)},globalThis.V8Bridge_ToHostSync=function(e){return s.ToHostSync(e)},globalThis.V8Bridge_GetStartingSyncId=function(){return s.GetStartingSyncId()},globalThis.V8Bridge_SetFromHostCallback=function(e){null==c||c(),c=s.registerForFromHost(e)}),e.makeBridge=function(e){return new(function(){function e(e){var n=this;this._module=e,a&&(this._module={start:function(e,t){n._wv2OnConnectedUnreg=s.registerForOnConnected((function(e){t.onConnected(i.PIE2API_ConnectedArgs(e))})),n._wv2OnDownloadingSCUnreg=s.registerForOnDownloadingSlimCore((function(e){t.onDownloadingSlimCoreEx?t.onDownloadingSlimCoreEx(e):t.onDownloadingSlimCore()})),n._wv2OnDisconnectedUnreg=s.registerForOnDisconnected((function(e){t.onDisconnectedEx?t.onDisconnectedEx(i.PIE2API_DisconnectedArgs(e)):t.onDisconnected()})),n._wv2OnTelemetryUnreg=s.registerForOnTelemetry(t.onTelemetry),s.Start(e)},stop:function(){var e,t,r,o;s.Stop(),null===(e=n._wv2OnConnectedUnreg)||void 0===e||e.call(n),null===(t=n._wv2OnDownloadingSCUnreg)||void 0===t||t.call(n),null===(r=n._wv2OnDisconnectedUnreg)||void 0===r||r.call(n),null===(o=n._wv2OnTelemetryUnreg)||void 0===o||o.call(n)},getVersion:null,V8Bridge_ToHost:null,V8Bridge_ToHostSync:null,V8Bridge_GetStartingSyncId:null,V8Bridge_SetFromHostCallback:null})}return e.prototype.start=function(e,n){var t;e.forceVersion=null!==(t=e.forceVersion)&&void 0!==t?t:this.getVersion(),this._module.start(e,n),a||(globalThis.V8Bridge_ToHost=this._module.V8Bridge_ToHost,globalThis.V8Bridge_ToHostSync=this._module.V8Bridge_ToHostSync,globalThis.V8Bridge_GetStartingSyncId=this._module.V8Bridge_GetStartingSyncId,globalThis.V8Bridge_SetFromHostCallback=this._module.V8Bridge_SetFromHostCallback)},e.prototype.stop=function(){this._module.stop()},e.prototype.getVersion=function(){return n.SLIMCORE_VERSION},e}())(e)}}(),r}()}));
//# sourceMappingURL=scpie-vdi-bridge-bundle.min.js.map